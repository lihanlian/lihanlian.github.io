---
title: "Hamiltonian and Pontryagin's Maximum Principle"
date: 2024-06-16
permalink: /posts/2024/06/16
tags:
  - Euler-Largrange Equation
  - Calculus of Variations
  - Contrained Optimization
---

| Derivative                           | Description                                                                 | Ease         |
|--------------------------------------|-----------------------------------------------------------------------------|--------------|
| \\( \frac{\partial L}{\partial z(t_1)} \\) | Gradient of loss with respect to output.                                      | Easy         |
| \\( \frac{dz(t_1)}{d\theta} \\)      | Jacobian of output with respect to params.                                   | Not easy     |
| \\( \lambda(t) \\)                   | Derivative of lambda, a vector, with respect to time.                         | Easy         |
| \\( \lambda(t) \frac{\partial f}{\partial z} \\) | vector-Jacobian Product. Can compute with reverse mode autodiff without explicitly constructing Jacobian \\( \frac{\partial f}{\partial z} \\). | Easy         |
| \\( \frac{dz(t)}{d\theta} \\)        | Jacobian of arbitrary layer with respect to params.                           | Not easy     |
| \\( \lambda(t) \frac{\partial f}{\partial \theta} \\) | vector-Jacobian Product. Can compute with reverse mode autodiff without explicitly constructing Jacobian \\( \frac{\partial f}{\partial \theta} \\). | Easy         |

So we see that (10) requires calculating \\( \frac{dz(t)}{d\theta} \\) at the very last point in time \\( t_1 \\) (output layer) and possibly any general point in time \\( t \\) (arbitrary hidden layer). That is exactly what we're trying to avoid!

Can we get rid of \\( \frac{dz(t)}{d\theta} \\) from (10) by making a judicious choice of \\( \lambda(t) \\)? üßê

What if we define \\( \lambda(t) \\) to be such that it satisfies the following ODE that runs backwards in time, starting at \\( t_1 \\) and ending at \\( t_0 \\)

\[
\lambda(t) = -\lambda(t) \frac{\partial f}{\partial z} \quad \text{s.t.} \quad \lambda(t_1) = \frac{\partial L}{\partial z(t_1)}
\]

giving

\[
\lambda(t_0) = \lambda(t_1) - \int_{t_1}^{t_0} \lambda(t) \frac{\partial f}{\partial z} \, dt \tag{11}
\]

Like magic, the first two terms in (10) - the ones containing \\( \frac{dz}{d\theta} \\) - will simply zero out!!! üòçüéâ
